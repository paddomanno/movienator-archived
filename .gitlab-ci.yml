image:
  name: docker:latest

services:
  - docker:18.09.7-dind

variables:
  DOCKER_HOST: tcp://localhost:2375/

build:
  script:
    - apk add --no-cache docker-compose

test:
  stage: test
  before_script:
    - docker version
    - docker-compose version
  script:
    - ls
    - docker-compose -f .\docker-compose-test.yml down
    - docker-compose -f .\docker-compose-test.yml build
    - docker-compose -f .\docker-compose-test.yml up -d
  after_script:
    - docker-compose -f .\docker-compose-test.yml down